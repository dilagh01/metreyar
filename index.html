k<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="UTF-8">
<title>سیاه و سفید فقط متن</title>
<style>
  body { background: white; text-align: center; }
  canvas { border: 1px solid #aaa; margin-top: 20px; }
</style>
</head>
<body>
<h1>فیلتر: فقط نوشته‌ها و خطوط تیره</h1>
<input type="file" id="upload" accept="image/*">
<br>
<canvas id="c"></canvas>

<script>
let fileInput = document.getElementById("upload");
let canvas = document.getElementById("c");
let ctx = canvas.getContext("2d");

fileInput.addEventListener("change", e => {
  let file = e.target.files[0];
  if (!file) return;
  
  let img = new Image();
  img.onload = function() {
    canvas.width = img.width;
    canvas.height = img.height;
    ctx.drawImage(img, 0, 0);

    let imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
    let data = imageData.data;

    for (let i = 0; i < data.length; i += 4) {
      let brightness = 0.299 * data[i] + 0.587 * data[i+1] + 0.114 * data[i+2];
      if (brightness < 160) { // هر چی تیره‌تر از این باشه → سیاه
        data[i] = 0;
        data[i+1] = 0;
        data[i+2] = 0;
      } else { // روشن → سفید
        data[i] = 255;
        data[i+1] = 255;
        data[i+2] = 255;
      }
    }

    ctx.putImageData(imageData, 0, 0);
  };
  
  img.src = URL.createObjectURL(file);
});
</script>
</body>
</html>
