<!DOCTYPE html>
<html lang="fa">
<head>
  <meta charset="UTF-8">
  <title>OCR در مرورگر</title>
  <script src="https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js"></script>
  <style>
    body { font-family: sans-serif; text-align: center; padding: 30px; }
    #output { white-space: pre-wrap; text-align: left; background: #f5f5f5; padding: 15px; border-radius: 8px; }
    .loader { display: none; margin: 20px auto; border: 4px solid #f3f3f3; border-top: 4px solid #3498db; border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; }
    @keyframes spin { 100% { transform: rotate(360deg); } }
  </style>
</head>
<body>

  <h1>OCR در مرورگر با Tesseract.js</h1>
  <input type="file" id="fileInput" accept="image/*,.pdf">
  <div class="loader" id="loader"></div>
  <h3>خروجی OCR:</h3>
  <div id="output">فایل خود را انتخاب کنید...</div>

  <script>
    const fileInput = document.getElementById('fileInput');
    const outputDiv = document.getElementById('output');
    const loader = document.getElementById('loader');

    fileInput.addEventListener('change', async (event) => {
      const file = event.target.files[0];
      if (!file) return;

      outputDiv.textContent = "در حال پردازش...";
      loader.style.display = "block";

      try {
        const worker = await Tesseract.createWorker('fas'); // زبان فارسی
        const { data: { text } } = await worker.recognize(file);
        outputDiv.textContent = text;
        await worker.terminate();
      } catch (err) {
        outputDiv.textContent = "خطا در OCR: " + err.message;
      }

      loader.style.display = "none";
    });
  </script>

</body>
</html>
